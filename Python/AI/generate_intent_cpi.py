import json
import random
from itertools import product

busan_gu = [
    "중구",
    "서구",
    "동구",
    "영도구",
    "부산진구",
    "동래구",
    "남구",
    "북구",
    "해운대구",
    "사하구",
    "금정구",
    "강서구",
    "연제구",
    "수영구",
    "사상구",
    "기장군",
]

years = ["2024", "2025"]
months = [f"{m:02d}" for m in range(1, 13)]

types = ["전입", "전출"]

chart_types = [
    "지역별 현황 차트",
    "월별 변화 차트",
    "기업규모별 직원수 차트",
    "업종별 직원수 차트",
    "세부 산업별 TOP10 차트",
    "산업별 TOP10 차트",
    "기업주체별 현황 차트",
]

# 대분류 + 중분류
industries = [
    ("농업, 임업 및 어업", ["농업", "임업", "어업"]),
    (
        "광업",
        [
            "석탄, 원유 및 천연가스 광업",
            "금속 광업",
            "비금속광물 광업: 연료용 제외",
            "광업 지원 서비스업",
        ],
    ),
    (
        "제조업",
        [
            "식료품 제조업",
            "음료 제조업",
            "담배 제조업",
            "섬유제품 제조업: 의복 제외",
            "의복, 의복 액세서리 및 모피제품 제조업",
            "가죽, 가방 및 신발 제조업",
            "목재 및 나무제품 제조업: 가구 제외",
            "펄프, 종이 및 종이제품 제조업",
            "인쇄 및 기록매체 복제업",
            "코크스, 연탄 및 석유정제품 제조업",
            "화학 물질 및 화학제품 제조업: 의약품 제외",
            "의료용 물질 및 의약품 제조업",
            "고무 및 플라스틱제품 제조업",
            "비금속 광물제품 제조업",
            "1차 금속 제조업",
            "금속 가공제품 제조업: 기계 및 가구 제외",
            "전자 부품, 컴퓨터, 영상, 음향 및 통신장비 제조업",
            "의료, 정밀, 광학 기기 및 시계 제조업",
            "전기장비 제조업",
            "기타 기계 및 장비 제조업",
            "자동차 및 트레일러 제조업",
            "기타 운송장비 제조업",
            "가구 제조업",
            "기타 제품 제조업",
            "산업용 기계 및 장비 수리업",
        ],
    ),
    ("전기,가스,증기 및 공기조절 공급업", ["전기, 가스, 증기 및 공기조절 공급업"]),
    (
        "수도, 하수 및 폐기물 처리, 원료 재생업",
        [
            "수도업",
            "하수, 폐수 및 분뇨 처리업",
            "폐기물 수집, 운반, 처리 및 원료 재생업",
            "환경 정화 및 복원업",
        ],
    ),
    ("건설업", ["종합 건설업", "전문직별 공사업"]),
    (
        "도매 및 소매업",
        ["자동차 및 부품 판매업", "도매 및 상품 중개업", "소매업: 자동차 제외"],
    ),
    (
        "운수 및 창고업",
        [
            "육상 운송 및 파이프라인 운송업",
            "수상 운송업",
            "항공 운송업",
            "창고 및 운송관련 서비스업",
        ],
    ),
    ("숙박 및 음식점업", ["숙박업", "음식점 및 주점업"]),
    (
        "정보통신업",
        [
            "출판업",
            "영상ㆍ오디오 기록물 제작 및 배급업",
            "방송 및 영상ㆍ오디오물 제공 서비스업",
            "우편 및 통신업",
            "컴퓨터 프로그래밍, 시스템 통합 및 관리업",
            "정보서비스업",
        ],
    ),
    ("금융 및 보험업", ["금융업", "보험업", "금융 및 보험관련 서비스업"]),
    ("부동산업", ["부동산업"]),
    (
        "전문, 과학 및 기술서비스업",
        [
            "연구개발업",
            "전문 서비스업",
            "건축 기술, 엔지니어링 및 기타 과학기술 서비스업",
            "기타 전문, 과학 및 기술 서비스업",
        ],
    ),
    (
        "사업시설 관리, 사업지원 및 임대 서비스업",
        ["사업시설 관리 및 조경 서비스업", "사업 지원 서비스업", "임대업: 부동산 제외"],
    ),
    ("교육 서비스업", ["교육 서비스업"]),
    ("보건업 및 사회복지 서비스업", ["보건업", "사회복지 서비스업"]),
    (
        "예술, 스포츠 및 여가관련 서비스업",
        ["창작, 예술 및 여가관련 서비스업", "스포츠 및 오락관련 서비스업"],
    ),
    (
        "협회 및 단체, 수리 및 기타 개인 서비스업",
        ["협회 및 단체", "개인 및 소비용품 수리업", "기타 개인 서비스업"],
    ),
    (
        "가구 내 고용활동 및 달리 분류되지 않은 자가 소비 생산활동",
        [
            "가구 내 고용활동",
            "달리 분류되지 않은 자가 소비를 위한 가구의 재화 및 서비스 생산활동",
        ],
    ),
    ("국제 및 외국기관", ["국제 및 외국기관"]),
]

templates = [
    "{year}년 {month}월, {gu} {industry} {sub_industry} {type} 기업 수를 {chart}로 확인하고 싶어요",
    "{gu} {year}년 {month}월 {sub_industry} {type} 기업 수를 {chart}로 보고 싶습니다",
    "{year}.{month} {gu} {sub_industry} 전{type} 기업 수를 {chart}로 분석할 수 있을까요",
    "{gu} {sub_industry} {year}년 {month}월 전{type} 기업 수를 {chart}로 확인하고 싶어요",
]

data = []
while len(data) < 200:
    gu = random.choice(busan_gu)
    year = random.choice(years)
    month = random.choice(months)
    typ = random.choice(types)
    chart = random.choice(chart_types)
    industry, sub_list = random.choice(industries)
    sub_industry = random.choice(sub_list)
    template = random.choice(templates)
    message = template.format(
        year=year,
        month=month,
        gu=gu,
        industry=industry,
        sub_industry=sub_industry,
        type=typ,
        chart=chart,
    )
    data.append({"intent": "REQ_ANALYSIS", "category": "cpi", "messages": message})

with open("app/data/busan_cpi_training_200.jsonl", "w", encoding="utf-8") as f:
    for entry in data:
        f.write(json.dumps(entry, ensure_ascii=False) + "\n")

print("총 데이터 수:", len(data))
